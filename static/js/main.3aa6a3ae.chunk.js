(this["webpackJsonpweather-widget"]=this["webpackJsonpweather-widget"]||[]).push([[0],{51:function(e,t,n){"use strict";n.r(t);var r,i,a,c,o,s,l,d,u,m,g,b,p,f,h,j,w,x,v=n(29),O=n(30),y=n(31),E=n(36),k=n(37),N=n(1),C=n.n(N),S=n(32),z=n.n(S),A=n(22),D=n(4),R=n(2),L=function(){return Object(R.jsxs)("div",{className:"loader",children:[Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{})]})},M=n(55),I=["title","titleId"];function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function H(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function P(e,t){var n=e.title,v=e.titleId,O=H(e,I);return N.createElement("svg",W({id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",ref:t,"aria-labelledby":v},O),n?N.createElement("title",{id:v},n):null,r||(r=N.createElement("g",null,N.createElement("g",null,N.createElement("path",{d:"M257,0C117.105,0,0,113.025,0,255c0,141.19,116.449,257,257,257c142.13,0,255-117.257,255-257 C512,114.061,397.951,0,257,0z M257,482.2C131.832,482.2,29.8,380.168,29.8,255C29.8,130.935,131.832,29.8,257,29.8 c124.065,0,225.2,101.135,225.2,225.2C482.2,380.168,381.065,482.2,257,482.2z"})))),i||(i=N.createElement("g",null,N.createElement("g",null,N.createElement("path",{d:"M257,60C149.21,60,60,147.491,60,255c0,52.603,20.817,103.589,57.114,139.886c5.853,5.854,15.356,5.857,21.213,0 l21.265-21.265c5.857-5.858,5.857-15.355,0-21.213c-5.857-5.857-15.355-5.857-21.213,0l-10.151,10.151 C106.889,336.72,93.676,304.164,90.663,270H105c8.284,0,15-6.716,15-15s-6.716-15-15-15H90.697 c3.129-34.135,16.816-65.304,37.812-90.277l9.87,9.87c5.857,5.857,15.355,5.858,21.213,0c5.858-5.858,5.858-15.355,0-21.213 l-9.791-9.791C175.229,107.505,207.083,93.76,242,90.674V105c0,8.284,6.716,15,15,15s15-6.716,15-15V90.689 c33.219,3.008,63.624,15.9,88.248,35.709l-129.301,91.907C217.831,227.629,210,241.346,210,255c0,1.025,0.038,2.043,0.113,3.053 C211.815,281.088,232.594,300,257,300c14.542,0,28.257-7.082,36.694-18.948l91.907-129.301 c19.809,24.624,32.702,55.03,35.71,88.249H407c-8.284,0-15,6.716-15,15s6.716,15,15,15h14.334 c-3.021,34.114-16.252,66.65-37.617,92.503l-10.096-10.096c-5.858-5.858-15.355-5.858-21.213,0 c-5.858,5.858-5.858,15.355,0,21.213l21.207,21.208c5.854,5.853,15.356,5.858,21.213,0C431.162,358.495,452,307.529,452,255 C452,147.497,364.61,60,257,60z M269.242,263.671C266.425,267.634,261.849,270,257,270c-8.738,0-17-7.29-17-15 c0-3.782,3.347-8.702,8.328-12.243l72.316-51.402L269.242,263.671z"})))),a||(a=N.createElement("g",null,N.createElement("g",null,N.createElement("path",{d:"M287,362h-62c-24.813,0-45,20.187-45,45s20.187,45,45,45h62c24.813,0,45-20.187,45-45S311.813,362,287,362z M287,422h-62 c-8.271,0-15-6.729-15-15s6.729-15,15-15h62c8.271,0,15,6.729,15,15S295.271,422,287,422z"})))),c||(c=N.createElement("g",null)),o||(o=N.createElement("g",null)),s||(s=N.createElement("g",null)),l||(l=N.createElement("g",null)),d||(d=N.createElement("g",null)),u||(u=N.createElement("g",null)),m||(m=N.createElement("g",null)),g||(g=N.createElement("g",null)),b||(b=N.createElement("g",null)),p||(p=N.createElement("g",null)),f||(f=N.createElement("g",null)),h||(h=N.createElement("g",null)),j||(j=N.createElement("g",null)),w||(w=N.createElement("g",null)),x||(x=N.createElement("g",null)))}var U=N.forwardRef(P);n.p;var F=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},T=Object(N.memo)((function(e){var t,n=e.city,r=e.data;return r?Object(R.jsxs)("div",{className:"weather-widget-data",children:[Object(R.jsxs)("div",{className:"weather-widget-city",children:[n,", ",r.city.country]}),Object(R.jsxs)("div",{className:"weather-widget-icon",children:[(t=r.weather.icon,Object(R.jsx)("img",{src:"https://openweathermap.org/img/wn/".concat(t,"@2x.png"),alt:""})),Object(R.jsxs)("span",{className:"weather-widget-temp",children:[Math.round(r.temperature.value),"\xb0C"]})]}),Object(R.jsxs)("div",{className:"weather-widget-description",children:["Feels like ",Math.round(r.feels_like.value),"\xb0C."," ",F(r.clouds.name),". ",r.wind.speed.name]}),Object(R.jsxs)("div",{className:"weather-widget-list",children:[Object(R.jsxs)("div",{className:"weather-widget-list-item",children:[Object(R.jsx)(M.a,{}),r.wind.speed.value,r.wind.speed.unit," ",r.wind.direction.code]}),Object(R.jsxs)("div",{className:"weather-widget-list-item",children:[Object(R.jsx)(U,{}),r.pressure.value,r.pressure.unit]}),Object(R.jsxs)("div",{className:"weather-widget-list-item",children:["Humidity: ",r.humidity.value,r.humidity.unit]}),Object(R.jsxs)("div",{className:"weather-widget-list-item",children:["Visibility: ",(r.visibility.value/1e3).toFixed(1),"km"]})]})]}):null})),J=n(56),V=function(e){var t=e.error;return Object(R.jsxs)("div",{className:"weather-widget-error",children:[Object(R.jsx)("div",{className:"weather-widget-error-icon",children:Object(R.jsx)(J.a,{})}),t]})},_=n(7),B=n.n(_),Z=n(9),q=n(33),G=n.n(q);function X(e){return fetch(e).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.text().then((function(e){return G.a.parse(e,{parseAttributeValue:!0,ignoreAttributes:!1,attributeNamePrefix:""})}))}))}var K=function(){var e=Object(Z.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.city,e.abrupt("return",X("https://api.openweathermap.org/data/2.5/weather?"+new URLSearchParams({q:n,appid:"2fa87f8cb6a6b40cbc14d416da4a021a",units:"metric",mode:"xml"})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(Z.a)(B.a.mark((function e(t){var n,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lat,r=t.lon,e.abrupt("return",X("https://api.openweathermap.org/data/2.5/weather?"+new URLSearchParams({lat:n.toString(),lon:r.toString(),appid:"2fa87f8cb6a6b40cbc14d416da4a021a",units:"metric",mode:"xml"})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Y(e,t){Object(N.useEffect)((function(){var n=function(n){var r=null===e||void 0===e?void 0:e.current;r&&!r.contains(n.composedPath()[0])&&t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}var $="WEATHER_WIDGETS",ee=[{city:"Moscow",data:null}],te=function(){var e=Object(N.useState)(!1),t=Object(D.a)(e,2),n=t[0],r=t[1],i=Object(N.useState)(null),a=Object(D.a)(i,2),c=a[0],o=a[1],s=function(){var e=Object(Z.a)(B.a.mark((function e(t){var n,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q({lat:t.coords.latitude,lon:t.coords.longitude});case 3:n=e.sent,i=n.current,o([{city:i.city.name,data:i}]),r(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),l();case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),l=function(){o(ee),r(!0)};return Object(N.useEffect)((function(){(function(){var e=localStorage.getItem($);if(e)try{var t=JSON.parse(e).map((function(e){return{city:e,data:null}}));return o(t),r(!0),!0}catch(n){return localStorage.removeItem($),!1}return!1})()||(navigator.geolocation?navigator.geolocation.getCurrentPosition(s,l):l())}),[]),[c,n]},ne=Object(N.memo)((function(e){var t=e.city,n=e.data,r=e.onUpdate,i=function(e){var t=Object(N.useState)(null),n=Object(D.a)(t,2),r=n[0],i=n[1],a=Object(N.useState)(null),c=Object(D.a)(a,2),o=c[0],s=c[1],l=Object(N.useState)(!1),d=Object(D.a)(l,2),u=d[0],m=d[1];return Object(N.useEffect)((function(){!function(){var t=Object(Z.a)(B.a.mark((function t(){var n,r;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m(!0),t.prev=1,t.next=4,K({city:e});case 4:n=t.sent,r=n.current,i(r),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),s(t.t0?t.t0.toString():"Server error");case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}()()}),[e]),Object(N.useEffect)((function(){(r||o)&&m(!1)}),[r,o]),[r,u,o]}(t),a=Object(D.a)(i,3),c=a[0],o=a[1],s=a[2];return Object(N.useEffect)((function(){c&&r(t,c)}),[c]),Object(R.jsx)("div",{className:"weather-widget-item",children:o?Object(R.jsx)(L,{}):s?Object(R.jsx)(V,{error:s}):Object(R.jsx)(T,{data:n,city:t})})})),re=n(61),ie=n(35),ae=n(57),ce=function(e){var t=e.onAdd,n=e.widgets,r=Object(N.useState)(""),i=Object(D.a)(r,2),a=i[0],c=i[1],o=Object(N.useState)(null),s=Object(D.a)(o,2),l=s[0],d=s[1];return Object(R.jsxs)("form",{className:"add-widget-form",onSubmit:function(e){e.preventDefault();var r=a.trim().length<2?"Enter 2 or more characters":n.some((function(e){return e.city.toLowerCase()===a.toLowerCase()}))?"Widget with city ".concat(F(a)," aleady exist"):null;r?d(r):(t(a),c(""))},children:[Object(R.jsx)("label",{className:"form-label",htmlFor:"add-city",children:"Add Location:"}),Object(R.jsxs)("div",{className:"form-row",children:[Object(R.jsx)("input",{id:"add-city",type:"text",className:"form-control",placeholder:"Enter a city",autoComplete:"off",value:a,onChange:function(e){var t=e.target.value;c(t)},onFocus:function(){l&&d(null)}}),Object(R.jsx)("button",{className:"btn add-widget-submit",type:"submit",children:Object(R.jsx)(ae.a,{})})]}),l&&Object(R.jsx)("div",{className:"form-error",children:l})]})},oe=n(64),se=n(63),le=n(59),de=n(60),ue=function(e){var t=e.city,n=e.index,r=e.onReorder,i=e.onDelete,a=Object(se.a)((function(){return{type:"weather-widget-item",item:{id:t,index:n},collect:function(e){return{isDragging:e.isDragging(),canDrag:!0}},end:function(e,t){var n=e.id,i=e.index;t.didDrop()||r(n,i)}}}),[t,n,r]),c=Object(D.a)(a,3),o=(c[0].isDragging,c[1]),s=c[2],l=Object(oe.a)((function(){return{accept:"weather-widget-item",canDrop:function(){return!1},hover:function(e){var i=e.id;i!==t&&r(i,n)}}}),[r]),d=Object(D.a)(l,2)[1];return Object(R.jsxs)("div",{ref:s,className:"widgets-settings-item",children:[Object(R.jsx)("div",{className:"widget-drag-trigger",ref:function(e){return o(d(e))},children:Object(R.jsx)(le.a,{})}),Object(R.jsx)("span",{className:"widget-settings-item-title",children:t}),Object(R.jsx)("button",{type:"button",className:"widget-delete-btn btn",onClick:function(){i(t)},children:Object(R.jsx)(de.a,{})})]},t)},me=function(e){var t=e.widgets,n=e.onReorder,r=e.onDelete,i=Object(oe.a)((function(){return{accept:"weather-widget-item"}})),a=Object(D.a)(i,2)[1];return Object(R.jsx)("div",{className:"widgets-settings-list",ref:a,children:t.map((function(e,t){var i=e.city;return Object(R.jsx)(ue,{city:i,index:t,onReorder:n,onDelete:r},i)}))})},ge=function(e){var t=e.isOpen,n=e.widgets,r=e.onAdd,i=e.onDelete,a=e.onReorder,c=["widget-settings-dropdown",t?"is-open":"is-close"].join(" ");return Object(R.jsxs)("div",{className:c,children:[Object(R.jsx)(re.a,{backend:ie.a,children:Object(R.jsx)(me,{widgets:n,onReorder:a,onDelete:i})}),Object(R.jsx)(ce,{onAdd:r,widgets:n})]})},be=n(62),pe=Object(N.memo)((function(e){var t=e.widgets,n=e.onWidgetAdd,r=e.onWidgetDelete,i=e.onWidgetsReorder,a=Object(N.useState)(!1),c=Object(D.a)(a,2),o=c[0],s=c[1],l=Object(N.useRef)(null);return Y(l,Object(N.useCallback)((function(){s(!1)}),[])),Object(R.jsxs)("div",{className:"weather-widget-settings",ref:l,children:[Object(R.jsx)("button",{className:"weather-widget-settings-btn btn",onClick:function(){s((function(e){return!e}))},children:Object(R.jsx)(be.a,{})}),Object(R.jsx)(ge,{isOpen:o,widgets:t,onAdd:n,onDelete:r,onReorder:i})]})})),fe=function(){var e=Object(N.useState)([]),t=Object(D.a)(e,2),n=t[0],r=t[1],i=function(e){var t=e.map((function(e){return e.city}));localStorage.setItem($,JSON.stringify(t)),r(e)},a=Object(N.useCallback)((function(e,t){var i=n.map((function(n){return n.city===e?{city:e,data:t}:n}));r(i)}),[n]),c=Object(N.useCallback)((function(e){i([].concat(Object(A.a)(n),[{city:e,data:null}]))}),[n]),o=Object(N.useCallback)((function(e){var t=n.filter((function(t){return t.city!==e}));i(t)}),[n]),s=Object(N.useCallback)((function(e,t){var r=n.findIndex((function(t){return t.city===e}));r>-1&&i(function(e,t,n){var r=Object(A.a)(e),i=r.splice(t,1),a=Object(D.a)(i,1)[0];return r.splice(n,0,a),r}(n,r,t))}),[n]),l=te(),d=Object(D.a)(l,2),u=d[0],m=d[1];return Object(N.useEffect)((function(){u&&r(u)}),[u]),Object(R.jsxs)("div",{className:"weather-widget",children:[Object(R.jsx)(pe,{widgets:n,onWidgetAdd:c,onWidgetDelete:o,onWidgetsReorder:s}),m?n.map((function(e){var t=e.city,n=e.data;return Object(R.jsx)(ne,{city:t,data:n,onUpdate:a},t)})):Object(R.jsx)(L,{})]})},he=function(){return Object(R.jsx)("div",{className:"App",children:Object(R.jsx)(fe,{})})},je=function(e){Object(y.a)(n,e);var t=Object(E.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(O.a)(n,[{key:"connectedCallback",value:function(){var e=document.createElement("div");e.innerHTML="<style>".concat(".App{margin:0;font-family:'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', 'Arial', sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.App *,.App *:after,.App *:before{box-sizing:border-box}.btn{border:none;box-shadow:none;background:transparent;padding:0;cursor:pointer}.loader{display:inline-block;position:relative;width:80px;height:80px;margin:auto}.loader div{display:inline-block;position:absolute;left:8px;width:16px;background:#64b5f6;animation:loader 1.2s cubic-bezier(0, 0.5, 0.5, 1) infinite}.loader div:nth-child(1){left:8px;animation-delay:-0.24s}.loader div:nth-child(2){left:32px;animation-delay:-0.12s}.loader div:nth-child(3){left:56px;animation-delay:0}@keyframes loader{0%{top:8px;height:64px}50%,100%{top:24px;height:32px}}.weather-widget{position:relative;display:flex;flex-wrap:wrap}.weather-widget-settings{position:absolute;right:2rem;top:2rem}.weather-widget-item{max-width:300px;padding:1rem}.weather-widget-city{text-transform:capitalize;font-weight:700}.weather-widget-icon{display:flex;align-items:center}.weather-widget-temp{font-size:2rem;font-weight:bold}.weather-widget-description{margin-bottom:1rem;font-size:.75rem}.weather-widget-list{display:flex;flex-wrap:wrap}.weather-widget-list-item{flex:0 0 50%;display:flex;align-items:center;font-size:.75rem;margin-bottom:.5rem}.weather-widget-list-item svg{width:1.3rem;height:1.3rem;margin-right:.5rem}.weather-widget-list-item:nth-child(odd){padding-right:1rem}.weather-widget-error{text-align:center}.weather-widget-error-icon{font-size:3.5rem;margin-bottom:.5rem;color:red}.widget-settings-dropdown{position:absolute;top:100%;right:0;opacity:0;transform:perspective(500px) translateZ(-200px);transform-origin:center center;transition:opacity .3s ease-in-out, transform .3s ease-in-out;background:#fff;border:1px solid #dcdcdc;padding:1rem;border-radius:4px;min-width:250px;max-width:300px;box-shadow:0px 0px 10px rgba(0,0,0,0.2);z-index:-1}.widget-settings-dropdown.is-open{z-index:1;opacity:1;transform:perspective(0) translateZ(0)}.weather-widget-settings-btn{padding:.5rem;font-size:1.5rem;cursor:pointer;border-radius:4px;transition:color .3s ease-in-out, background-color .3s ease-in-out;line-height:0}.weather-widget-settings-btn:hover{background:#000;color:#fff}.widgets-settings-item{display:flex;align-items:center;padding:.5rem 1rem;background:#dcdcdc;margin-bottom:1rem}.widget-drag-trigger{margin-right:.5rem;cursor:move;font-size:1.25rem;line-height:0}.widget-settings-item-title{text-transform:capitalize}.widget-delete-btn{margin-left:auto;font-size:1.25rem;line-height:0;cursor:pointer;transition:color .3s ease-in-out}.widget-delete-btn:hover{color:red}.add-widget-form{margin-top:2rem}.form-label{font-weight:700;margin-bottom:.25rem;display:block}.form-row{display:flex;align-items:center}.form-control{height:2rem;line-height:2rem;flex-grow:1;padding:0 1rem;border-radius:4px;border:1px solid #dcdcdc}.form-error{margin-top:.5rem;font-size:.75rem;color:red}.add-widget-submit{padding:0.4rem;font-size:1.25rem;height:100%;line-height:0;transition:color .3s ease-in-out, background-color .3s ease-in-out;border-radius:4px}.add-widget-submit:hover{background:#000;color:#fff}\n","</style>");var t=document.createElement("div");e.appendChild(t),this.attachShadow({mode:"open"}).appendChild(e),z.a.render(Object(R.jsx)(C.a.StrictMode,{children:Object(R.jsx)(he,{})}),t)}}]),n}(Object(k.a)(HTMLElement));customElements.define("weather-widget",je)}},[[51,1,2]]]);
//# sourceMappingURL=main.3aa6a3ae.chunk.js.map